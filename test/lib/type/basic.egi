-- Basic type system tests

-- Simple typed function
def double (x : Integer) : Integer := x * 2

assertEqual "typed function double" (double 5) 10

-- Typed function with list
def myLength (xs : [a]) : Integer :=
  match xs as list something with
    | [] -> 0
    | _ :: $rest -> 1 + myLength rest

assertEqual "typed function myLength" (myLength [1, 2, 3, 4, 5]) 5

-- Typed function with multiple parameters
def myAdd (x : Integer) (y : Integer) : Integer := x + y

assertEqual "typed function myAdd" (myAdd 3 4) 7

-- Typed function with Bool
def myNot (b : Bool) : Bool := if b then False else True

assertEqual "typed function myNot True" (myNot True) False
assertEqual "typed function myNot False" (myNot False) True

-- Typed function with tuple
def swap (p : (a, b)) : (b, a) :=
  match p as (something, something) with
    | ($x, $y) -> (y, x)

assertEqual "typed function swap" (swap (1, "hello")) ("hello", 1)

-- Higher-order typed function
def myMap (f : a -> b) (xs : [a]) : [b] :=
  match xs as list something with
    | [] -> []
    | $x :: $rest -> f x :: myMap f rest

assertEqual "typed function myMap" (myMap (\x -> x * 2) [1, 2, 3]) [2, 4, 6]

-- MathExpr type (equivalent to Integer)
def mathFunc (x : MathExpr) : MathExpr := x * x

assertEqual "MathExpr type" (mathFunc 5) 25

-- MathExpr in tensor type
def mathTensor : Tensor MathExpr [2] := [| 1, 2 |]

assertEqual "MathExpr tensor" (tensorToList mathTensor) [1, 2]
